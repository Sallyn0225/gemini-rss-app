
version: '3'

services:
  gemini-rss:
    build: .
    image: gemini-rss-app
    container_name: gemini-rss
    # 使用 bridge 模式，通过 Docker 网关访问宿主机服务
    # 容器内宿主机 IP 为 172.17.0.1（默认 Docker 网关）
    
    restart: always
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      # 管理密钥：请务必修改为强密码！
      - ADMIN_SECRET=pwd123
      
      # ============ 可选代理配置 ============
      # 国内服务器：设置此变量以通过代理访问外部资源（如 Twitter）
      # 格式: http://host:port 或 http://user:pass@host:port
      # 示例（宿主机运行 Clash）:
      - UPSTREAM_PROXY=http://172.17.0.1:7890
      
      # 海外服务器：注释或删除上面的 UPSTREAM_PROXY 行即可直连
      # - UPSTREAM_PROXY=
      # =====================================
      
    volumes:
      # 持久化数据目录
      - ./data:/app/data

    # 日志轮转，防止日志占满磁盘
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
