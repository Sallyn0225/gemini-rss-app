
version: '3'

services:
  gemini-rss:
    build: .
    image: gemini-rss-app
    container_name: gemini-rss
    # 改用bridge模式：更安全，通过指定IP访问宿主机代理
    # 容器内宿主机IP为172.17.0.1（Docker网关）
    
    restart: always
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      # Define your admin secret here
      - ADMIN_SECRET=pwd123 # 请在使用前一定要修改一个强密码！！！
      # 代理配置：指向宿主机IP和端口
      - PROXY_HOST=172.17.0.1
      - PROXY_PORT=7890
    volumes:
      # Mount a directory for persistent data, not a single file
      # This prevents Docker from creating a directory instead of a file
      - ./data:/app/data

    # 日志轮转，防止日志占满磁盘
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
